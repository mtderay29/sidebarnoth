<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Sidebar Notes</title>

<style>
:root {
  --bg:#1e1e1e;--panel:#252526;--border:#333;
  --text:#e6e6e6;--muted:#9e9e9e;
  --accent:#4fc3f7;--danger:#ff6b6b;
}
*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:var(--bg);color:var(--text);height:100vh;display:flex;flex-direction:column}
header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--panel);border-bottom:1px solid var(--border)}
header button{background:none;border:none;color:var(--text);font-size:18px;cursor:pointer}
main{flex:1;display:flex;overflow:hidden}
aside{width:45%;background:var(--panel);border-right:1px solid var(--border);overflow-y:auto}
.folder{border-bottom:1px solid var(--border)}
.folder-header{padding:8px 10px;cursor:pointer;font-weight:600}
.folder-header:hover{background:#2a2a2a}
.notes{padding-left:12px}
.note{padding:6px 10px;cursor:pointer;border-left:2px solid transparent}
.note:hover{background:#2a2a2a}
.note.active{border-left-color:var(--accent);color:var(--accent)}
.controls{padding:6px}
.controls button{width:100%;margin-bottom:4px;background:var(--accent);border:none;padding:5px;font-weight:600;cursor:pointer}
section{flex:1;padding:12px;overflow-y:auto}
input,textarea,select{width:100%;margin-bottom:8px;background:#1b1b1b;border:1px solid var(--border);color:var(--text);padding:6px}
textarea{min-height:140px}
.actions{display:flex;gap:6px}
.actions button{border:none;padding:6px;font-weight:600;cursor:pointer}
.save{background:var(--accent)}
.delete{background:var(--danger)}
.cancel{background:#555}
.muted{font-size:12px;color:var(--muted)}
</style>
</head>

<body>

<header>
  <div>üìÅ Notlar</div>
  <button id="toggleEdit">‚öôÔ∏è</button>
</header>

<main>
<aside>
  <div class="controls">
    <button onclick="startNewFolder()">‚ûï Yeni Klas√∂r</button>
  </div>
  <div id="folders"></div>
</aside>

<section id="content"></section>
</main>

<script>
const KEY="sidebar_folders_v3";
let folders=JSON.parse(localStorage.getItem(KEY))||[];
let current={folder:null,note:null,mode:null};
let edit=false;

if(!folders.length){
 folders.push({id:Date.now(),title:"Genel",open:true,notes:[]});
 save();
}

function save(){localStorage.setItem(KEY,JSON.stringify(folders));}

/* ---- YENƒ∞ KLAS√ñR AKI≈ûI ---- */
function startNewFolder(){
 current={folder:{title:""},note:null,mode:"new-folder"};
 edit=true;
 render();
}

function createFolder(){
 const name=document.getElementById("newFolderName").value.trim();
 if(!name)return;
 const f={id:Date.now(),title:name,open:true,notes:[]};
 folders.push(f);
 current={folder:f,note:null,mode:"folder"};
 edit=false;
 save();render();
}

/* ---- NOT ---- */
function newNote(fid){
 const f=folders.find(x=>x.id===fid);
 const n={id:Date.now(),title:"Yeni Not",content:""};
 f.notes.push(n);
 current={folder:f,note:n,mode:"note"};
 edit=true;save();render();
}

/* ---- RENDER ---- */
function render(){
 const fdiv=document.getElementById("folders");
 fdiv.innerHTML="";
 folders.forEach(f=>{
  const box=document.createElement("div");
  box.className="folder";

  const h=document.createElement("div");
  h.className="folder-header";
  h.textContent=(f.open?"üìÇ ":"üìÅ ")+f.title;
  h.onclick=()=>{current={folder:f,note:null,mode:"folder"};render();};
  h.ondblclick=()=>{f.open=!f.open;save();render();};
  box.appendChild(h);

  if(f.open){
   const ndiv=document.createElement("div");
   ndiv.className="notes";
   f.notes.forEach(n=>{
    const d=document.createElement("div");
    d.className="note"+(current.note?.id===n.id?" active":"");
    d.textContent=n.title||"(Ba≈ülƒ±ksƒ±z)";
    d.onclick=()=>{current={folder:f,note:n,mode:"note"};render();};
    ndiv.appendChild(d);
   });
   const btn=document.createElement("div");
   btn.className="note muted";
   btn.textContent="‚ûï Not ekle";
   btn.onclick=()=>newNote(f.id);
   ndiv.appendChild(btn);
   box.appendChild(ndiv);
  }
  fdiv.appendChild(box);
 });
 renderContent();
}

function renderContent(){
 const c=document.getElementById("content");
 if(!current.mode){c.innerHTML="<p class='muted'>Se√ßim yok</p>";return;}

 if(current.mode==="new-folder"){
  c.innerHTML=`
    <h3>üìÅ Yeni Klas√∂r</h3>
    <input id="newFolderName" placeholder="Klas√∂r adƒ±">
    <div class="actions">
      <button class="save" onclick="createFolder()">Olu≈ütur</button>
      <button class="cancel" onclick="cancel()">ƒ∞ptal</button>
    </div>`;
 }

 if(current.mode==="folder"){
  c.innerHTML=`<h3>üìÅ ${current.folder.title}</h3>`;
 }

 if(current.mode==="note"){
  const n=current.note;
  c.innerHTML= edit ? `
    <input id="t" value="${n.title}">
    <textarea id="c">${n.content}</textarea>
    <div class="actions">
      <button class="save" onclick="saveNote()">Kaydet</button>
      <button class="delete" onclick="deleteNote()">Sil</button>
    </div>` :
    `<h3>${n.title}</h3><p>${n.content}</p>`;
 }
}

function cancel(){
 current={folder:null,note:null,mode:null};
 edit=false;render();
}

function saveNote(){
 current.note.title=t.value;
 current.note.content=c.value;
 save();render();
}

function deleteNote(){
 current.folder.notes=current.folder.notes.filter(n=>n!==current.note);
 cancel();save();
}

toggleEdit.onclick=()=>{edit=!edit;render();};
render();
</script>

</body>
</html>
